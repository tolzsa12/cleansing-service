
# Cleansing API services using python

 อันนี้คือคำอธิบายสำหรับวิธีการใช้ API การคืนค่าของ API รวมไปถึง key, value ที่จำเป็นต้องเพิ่มใน API แต่ละเส้น

## Function 1: Rename Column Name เปลี่ยนชื่อคอลัมน์
ทำการเปลี่ยนชื่อ header โดยจะเปลี่ยนใน json ทั้งหมด 3 จุดคือ "label" และ "dataKey" ใน "columns" และ ชื่อคอลัมน์นั้น ๆ ใน "rows"
### /removeirrdata/check "POST"

- usage : ใช้สำหรับหน้า check ก่อนทำความสะอาดจริง
- return : คืนค่าออกมาเป็น json โดยจะมีสอง Keys คือ
    "columns" ซึ่ง value ของ label และ dataKey จะถูกเปลี่ยนเป็นค่าที่ผู้ใช้กรอก และ "rows" ซึ่งค่าที่ตรงกับ dataKey ที่ถูกเปลี่ยนนั้น จะถูกเปลี่ยนตามไปด้วย นอกจากนี้จะคืนค่า st@tus เป็นสีเหลืองทุกช่อง เนื่องจากทำการเปลี่ยนชื่อคอลัมน์ทำให้ Dataset ถูกเปลี่ยนแปลง
- additiom :
    "columns_match" : 'คอลัมน์ที่ผู้ใช้เลือก' (สามารถเลือกได้คอลัมน์เดียว)
    "header_new" : "ชื่อคอลัมน์ใหม่"

### /removeirrdata/clean "POST"
- usage : ใช้สำหรับทำความสะอาดข้อมูลจริง
- return : คืนค่าออกมาเป็น json โดยจะมีสอง Keys คือ
    "columns" ซึ่ง value ของ label และ dataKey จะถูกเปลี่ยนเป็นค่าที่ผู้ใช้กรอก และ "rows" ซึ่งค่าที่ตรงกับ dataKey ที่ถูกเปลี่ยนนั้น จะถูกเปลี่ยนตามไปด้วย 
- additiom :
    "columns_match" : 'คอลัมน์ที่ผู้ใช้เลือก' (สามารถเลือกได้คอลัมน์เดียว)
    "header_new" : "ชื่อคอลัมน์ใหม่"
## Function 2: Remove Irrelevant Data ลบข้อมูลที่ไม่เกี่ยวข้อง

### /removeirrdata/check "POST"
- usage : ใช้สำหรับหน้า check ก่อนทำความสะอาดจริง
- return : ค่าออกมาเป็น json ที่มีค่า st@tus "edit" ทุกตัว เนื่องจากทำการลบ "ทั้งคอลัมน์" , ข้อมูลทุกตัวในชุดข้อมูลจึงถูกเปลี่ยนแปลงทั้งหมด (โดยข้อมูลที่แสดงจะเป็นข้อมูลที่เปลี่ยนแปลงแล้ว)
- addition : 
    "columns_match" : ['คอลัมน์ที่ผู้ใช้เลือก']

### /removeirrdata/clean "POST"
- usage : ใช้สำหรับการทำความสะอาดจริง
- return : ค่าออกมาเป็น json ที่ถูกลบ columns ที่ไม่จำเป็นทิ้ง
- addition :
    "columns_match" : ['คอลัมน์ที่ผู้ใช้เลือก']


## Function 3: Remove Duplicate Data ลบข้อมูลซ้ำ

### /removedupdata/check "POST"
- usage : ใช้สำหรับหน้า check ก่อนทำความสะอาดจริง
- return : ค่าออกมาเป็น json ที่มีค่า st@tus "delete" ที่แถวที่ต้องการลบ (โดยข้อมูลจะยังไม่ถูกลบในขั้นตอนนี้)
- addition:
    none

### /removedupdata/clean "POST"
- usage : ใช้สำหรับทำความสะอาดจริง
- return : ค่าออกมาเป็น json ที่ถูกลบข้อมูลที่ซ้ำกันแล้ว
- addition :
    none

## Function 4: Edit Inconsistent Data ลบข้อมูลที่ไม่สอดคล้อง
ฟังก์ชันนี้มีไว้เพื่อเปลี่ยนข้อมูลเดียวกันที่เก็บมาต่างกัน เช่น "กรุงเทพ" "กรุงเทพฯ" "กรุงเทพมหานคร" "กทม." โดยผู้ใช้จะต้องเลือกคอลัมน์ (ในฟังก์ชันนี้สามารถเลือกได้เพียงคอลัมน์เดียวเท่านั้น )จะแสดงค่า unique value ทั้งหมดออกมา ให้ผู้ใช้คลิก unique value จากนั้นจะขึ้นหน้า pop-up ให้ผู้ใช้คลิก และทำการเปลี่ยนเป็นข้อมูลตามที่ต้องการ

### /editincdata "POST"
- usage : ใช้สำหรับเรียกค่า unique value ทั้งหมดจาก columns ที่ผู้ใช้เลือก
- return : ค่าออกมาเป็น list ของ unique value
- addition : 
    "columns_match" : "คอลัมน์ที่ผู้เลือก(ได้คอลัมน์เดียว)"

### /editincdata/check "POST"
- usage : ใช้สำหรับเช็คข้อมูลก่อนทำความสะอาด
- return : ค่าออกมาเป็น json ที่มีค่า st@tus "edit" ในแถวที่มีการเปลี่ยนข้อมูลตามที่ผู้ใช้กรอก
- addition : 
    "columns_match" : "คอลัมน์ที่ผู้ใช้เลือก(ได้คอลัมน์เดียว)",
    "data_select" : "ข้อมูล unique value ที่ผู้ใช้ต้องการเปลี่ยน",
    "data_change" : "ข้อมูลรูปแบบใหม่ที่ผู้ใช้ต้องการ"

### /editincdata/clean "POST"
- usage : ใช้สำหรับทำความสะอาดข้อมูลจริง
- return : ค่าออกมาเป็น json ที่ถูกเปลี่ยนแปลงค่าแล้ว unique value จะหายไป 1 อัน เพราะไปรวมกับอันอื่น
- addition :
    "columns_match" : "คอลัมน์ที่ผู้ใช้เลือก(ได้คอลัมน์เดียว)",
    "data_select" : "ข้อมูล unique value ที่ผู้ใช้ต้องการเปลี่ยน",
    "data_change" : "ข้อมูลรูปแบบใหม่ที่ผู้ใช้ต้องการ"



## Function 5: Manage Unknown Value จัดการข้อมูลที่ขาดหายไป
ในฟังก์ชันนี้ผู้ใช้จะต้องเลือกฟังก์ชันย่อย -> (ถ้าเป็น "เติมค่าที่ต้องการไป" จะต้องมีช่องให้กรอกด้วย) -> แล้วถึงจะเลือกคอลัมน์

### /managenavalue/check "POST"
- usage : ใช้สำหรับเช็คข้อมูลก่อนทำความสะอาด
- return : 
    ถ้าผู้ใช้เลือก "mean","median", หรือเติมค่าอื่น ๆ ค่าออกมาเป็น json ที่มีค่า st@tus "edit" ในแถวที่มีการเติมค่าข้อมูล
    ถ้าผู้ใช้เลือก "remove" จะคืนค่าเป็น json ที่มีค่า st@tus "delete" ในแถวที่มีการตัดข้อมูล (ในการตัดข้อมูลนั้น จะดูด้วยว่า ข้อมูลว่างเกิน 10% ของข้อมูลทั้งหมดไหม ถ้าเกินจะไม่ตัด เพราะจะทำให้เสียข้อมูลเยอะเกินไป)
- addition :
    "order_select" : "คำสั่งที่ผู้ใช้ต้องการ" ("mean","median","remove",และค่าอื่น ๆ นอกเหนือจาก 3 ตัวนี้)
    "columns_match" : ["คอลัมน์ที่ผู้ใช้เลือก"]

### /managenavalue/clean "POST"
- usage : ใช้สำหรับทำความสะอาดข้อมูลจริง
- return : 
    ถ้าผู้ใช้เลือก "mean","median", หรือเติมค่าอื่น ๆ ค่าออกมาเป็น json ที่เติมค่าที่ผู้ใช้ต้องการ
    ถ้าผู้ใช้เลือก "remove" จะคืนค่าเป็น json ที่มีการตัดข้อมูล (ในการตัดข้อมูลนั้น จะดูด้วยว่า ข้อมูลว่างเกิน 10% ของข้อมูลทั้งหมดไหม ถ้าเกินจะไม่ตัด เพราะจะทำให้เสียข้อมูลเยอะเกินไป)

- addition :
    "order_select" : "คำสั่งที่ผู้ใช้ต้องการ" ("mean","median","remove",และค่าอื่น ๆ นอกเหนือจาก 3 ตัวนี้)
    "columns_match" : ["คอลัมน์ที่ผู้ใช้เลือก"]

## Function 6: Split Column แยกคอลัมน์
ในฟังก์ชันนี้จะทำการแยกคอลัมน์ตามตัวแบ่ง (delimiter) ตามที่ผู้ใช้กำหนด โดยจะไม่ทำการลบคอลัมน์ที่ถูกแบ่งไป เช่น มีคอลัมน์ "Date" ข้อมูลตัวอย่างเช่น "18/02/2566"
กำหนดค่า "column_1" : "Day", "column_2" = "Month", "delimiter" = "/"
จะได้ json ที่มีค่า
"Date" : "18/02/2566",
"Day" : "18",
"Month" : "02/2566" ออกมา *หากต้องการลบคอลัมน์ Date ออกเรามีฟังก์ชันที่ 1 อยู่แล้ว*
*ใช้ได้กับข้อมูลที่ไม่ใช่ตัวเลขเท่านั้น*

### /splitcolumn/check "POST"
- usage : ใช้สำหรับเช็คข้อมูลก่อนทำความสะอาด
- return : คืนค่าออกมาเป็น json ที่มีการแยกคอลัมน์ออกมา โดยจะเพิ่มคอลัมน์มาอีก 2 คอลัมน์ตามที่ผู้ใช้กำหนด หากข้อมูลในคอลัมน์ที่เลือกมาเป็น Null คอลัมน์ใหม่ทั้ง 2 คอลัมน์ก็จะเป็น Null ทั้งคู่ และจะมีค่า "st@tus" : "edit" ทุกแถวเนื่องจากสร้างคอลัมน์ใหม่
- addition :
    "columns_match" : "คอลัมน์ที่ผู้ใช้เลือก" (ได้แค่คอลัมน์เดียวเท่านั้น)
    "delimiter" : "ตัวแบ่งที่ผู้ใช้กำหนด"
    "column_1" : "คอลัมน์แรกหลังจากแยก"
    "column_2" : "คอลัมน์ที่ 2 หลังจากแยก"

### /splitcolumn/clean "POST"
- usage : ใช้สำหรับทำความสะอาดข้อมูลจริง
- return : คืนค่าออกมาเป็น json ที่มีการแยกคอลัมน์ออกมา โดยจะเพิ่มคอลัมน์มาอีก 2 คอลัมน์ตามที่ผู้ใช้กำหนด
- addition :
    "columns_match" : "คอลัมน์ที่ผู้ใช้เลือก" (ได้แค่คอลัมน์เดียวเท่านั้น)
    "delimiter" : "ตัวแบ่งที่ผู้ใช้กำหนด"
    "column_1" : "คอลัมน์แรกหลังจากแยก"
    "column_2" : "คอลัมน์ที่ 2 หลังจากแยก"


## Function 7: Merge Column รวมคอลัมน์
รวม 2 คอลัมน์ มาเป็นคอลัมน์เดียวผ่านตัวเชื่อม
(ขั้นตอนการทำงานคือ เลือกฟังก์ชันนี้ -> เลือกคอลัมน์ที่ 1 -> เลือกคอลัมน์ที่ 2 -> ผู้ใช้กรอก "เชื่อมโดย" และ "ชื่อคอลัมน์ใหม่")

### /joincolumns/check "POST"
- usage : ใช้สำหรับเช็คข้อมูลก่อนทำความสะอาด
- return : คืนค่าออกมาเป็น json ที่มีการรวมคอลัมน์ โดยไม่ลบคอลัมน์เดิมทิ้ง และข้อมูลทุกตัวจะมีค่า "st@tus" : "edit" เนื่องจากทุกแถวมีการสร้างคอลัมน์ใหม- addition : 
    "columns_match1" : "คอลัมน์แรกที่ผู้ใช้เลือก" (ได้แค่คอลัมน์เดียว)
    "columns_match2" :
    "คอลัมน์ที่สองที่ผู้ใช้เลือก"
    (ได้แค่คอลัมน์เดียว)
    "delimiter" : "ตัวเชื่อมที่ผู้ใช้กำหนด"
    "column_new" : "ชื่อคอลัมน์ใหม่จากการรวมคอลัมน์"

### /joincolumns/clean "POST"
- usage : ใช้สำหรับทำความสะอาดข้อมูลจริง
- return : คืนค่าออกมาเป็น json ที่มีการรวมคอลัมน์โดยไม่ลบคอลัมน์เดิมทิ้ง
addition : 
    "columns_match1" : "คอลัมน์แรกที่ผู้ใช้เลือก" (ได้แค่คอลัมน์เดียว)
    "columns_match2" :
    "คอลัมน์ที่สองที่ผู้ใช้เลือก"
    (ได้แค่คอลัมน์เดียว)
    "delimiter" : "ตัวเชื่อมที่ผู้ใช้กำหนด"
    "column_new" : "ชื่อคอลัมน์ใหม่จากการรวมคอลัมน์"

## Function 8: Manage Unknown Value จัดการข้อมูลที่ขาดหายไป
ในฟังก์ชันนี้จะทำการเปลี่ยนข้อมูลประเภท categories ที่มีจำนวนน้อยให้เป็น "อื่น ๆ" โดยจะทำการจัดลำดับ category ทั้งหมดว่า มีจำนวนเท่าไร และ categories ที่มีจำนวนน้อยกว่าลำดับที่ 10 จะถูกเปลี่ยนเป็นคำว่า "อื่น ๆ " ทั้งหมด (แต่ในโค้ดตอนนี้เป็นลำดับที่ 5 ก็ถูกเปลี่ยนออก) ถ้าหากผู้ใช้เลือกคอลัมน์ที่เป็นตัวเลข ไม่ว่าจะ int หรือ float จะไม่ถูกเปลี่ยนแปลงใด ๆ

### /replaceexcdata/check "POST"
- usage : ใช้เช็คข้อมูลก่อนทำความสะอาด
- return : คืนค่าเป็น json ที่มี status edit ในแถวข้อมูลที่ถูกเปลี่ยนเป็นอื่น ๆ (ข้อมูลที่เป็นคำว่า "อื่น ๆ" ตั้งแต่แรกจะไม่ขึ้น status นี้) และข้อมูล category (object) ที่มีจำนวนไม่เยอะเป็น 10 อันดับแรก จะถูกเปลี่ยนเป็นคำว่า อื่น ๆ ทั้งหมด และ st@tus จะเป็นคอลัมน์สุดท้าย // ต่างจากฟังก์ชันอื่น ๆ ที่ st@tus จะเป็นคอลัมน์แรก
- addition : "columns_match" : ["คอลัมน์ที่ผู้ใช้เลือก"]

### /replaceexcdata/clean "POST"
- usage : ใช้ทำความสะอาดข้อมูลจริง
- return : คืนค่าเป็น json ที่ category ที่มีจำนวนไม่เยอะเป็น 10 อันดับแรกถูกเปลี่ยนเป็น อื่น ๆ ทั้งหมด st@tus จะเป็นคอลัมน์สุดท้าย // ต่างจากฟังก์ชันอื่น ๆ ที่ st@tus จะเป็นคอลัมน์แรก
- addition : "columns_match" : ["คอลัมน์ที่ผู้ใช้เลือก"]

## Function 9: Remove Unreadable Numbers ลบข้อมูลที่อ่านเป็นตัวเลขไม่ได้
ในฟังก์ชันนี้จะทำการลบข้อมูลทั้งหมดที่ไม่ใช่ตัวเลขในคอลัมน์ เพื่อให้ได้ข้อมูลที่เหลือเป็นแบบตัวเลข และสามารถนำไปใช้คำนวณค่าทางสถิติได้ 
เหมาะสำหรับทำความสะอาดคอลัมน์ที่มีตัวเลขเป็นหลัก และมี String ติดเข้ามาบางตำแหน่ง
*ดังนั้นจึงควรระมัดระวังในการใช้ เพราะจะลบค่า String ทั้งหมด* 
*ยังไม่ได้เขียนฟังก์ชันรองรับค่า String ที่แปลงเป็นตัวเลขได้เช่น "13" หรือ "612.5" ดังนั้น ค่าที่เก็บมาในรูปแบบนี้จะถูกลบออกไปด้วยเช่นกันในตอนนี้*

หากเลือกคอลัมน์ที่มีแต่ตัวเลข เช่น int หรือ float จะไม่เกิดการเปลี่ยนแปลงใด ๆ

### /removeunrnumber/check "POST"
- usage : ใช้เช็คข้อมูลก่อนทำความสะอาด
- return : คืนค่าออกมาเป็น json โดย st@tus ของคอลัมน์ที่เลือกมาแล้วมี String นั้นจะเป็น "delete" แต่ว่าจะยังไม่ถูกลบออกจากชุดข้อมูล
- addition : "columns_match" : ["คอลัมน์ที่ผู้ใช้เลือก"]

### /removeunrnumber/clean "POST"
- usage : ใช้ทำความสะอาดข้อมูลจริง
- return : คืนค่าออกมาเป็น json โดยจะลบแถวข้อมูลที่คอลัมน์ที่เลือกมานั้นมี String มาอยู่
- addition : "columns_match" : ["คอลัมน์ที่ผู้ใช้เลือก"]

## Function 10: Flag Outliers ทำสัญลักษณ์ข้อมูลที่มีความผิดปกติทางสถิติ

ฟังก์ชันนี้จะทำการเพิ่ม Flag Column ไปที่ด้านขวาของคอลัมน์ที่เลือก เพื่อทำการระบุว่าในคอลัมน์ที่เลือกมานั้น มีค่าไหนเป็นค่าผิดปกติทางสถิติบ้าง หากเลือกคอลัมน์ที่ไม่ใช่ตัวเลข (หรือมีอะไรที่ไม่ใช่ตัวเลข)ฟังก์ชันจะไม่เกิดการเปลี่ยนแปลงใด ๆ
ใช้วิธีหา Outlier แบบ IQR

### /flagoutlier/check "POST"
- usage : ใช้เช็คข้อมูลก่อนทำความสะอาด
- return : คืนค่าออกมาเป็น json โดยหากคอลัมน์ที่เลือกมีคอลัมน์ที่เป็นตัวเลขทั้งหมด จะมี st@tus = "edit" ทุกตัวเนื่องจากเพิ่ม columns ในการ flag และ flag columns ("..._isoutlier") จะอยู่ทางด้านขวาของ columns ที่เราทำการ flag 
- addition : "columns_match" :
["คอลัมน์ที่ผู้ใช้เลือก"]

### /flagoutlier/clean "POST"
- usage : ใช้ทำความสะอาดข้อมูลจริง
- return : คืนค่าออกมาเป็น json ที่เพิ่ม flag columns ("..._isoutlier") โดยจะอยู่ทางขวาของ columns ที่เราทำการ flag
- addition : "columns_match" : 
["คอลัมน์ที่ผู้ใช้เลือก"]

## Function 11: Remove Outliers ลบค่าข้อมูลที่ผิดปกติทางสถิติ

ฟังก์ชันนี้จะทำการลบ "ทั้ง Row" ของข้อมูลที่มีค่าผิดปกติใน Column ที่ผู้ใช้เลือก
หากเลือกคอลัมน์ที่ไม่ใช่ตัวเลข (หรือมีอะไรที่ไม่ใช่ตัวเลข) ฟังก์ชันจะไม่เกิดการเปลี่ยนแปลงใด ๆ
ใช้วิธีหา Outlier แบบ IQR

### /removeoutlier/check "POST"
- usage : ใช้เช็คข้อมูลก่อนทำความสะอาด
- return : คืนค่าออกมาเป็น json ที่มี st@tus = "delete" ใน Rows ที่มีค่าผิดปกติทางสถิติ แต่จะยังไม่ถูกลบ
- addition : 
"columns_match" : ["คอลัมน์ที่ผู้ใช้เลือก"]

### /removeoutlier/clean "POST"
- usage : ใช้ทำความสะอาดข้อมูลจริง
- return : คืนค่าออกมาเป็น json ที่ลบ rows ที่มีค่าผิดปกติทางสถิติ
- addition : 
"columns_match" : ["คอลัมน์ที่ผู้ใช้เลือก"]

## Function 12: Change Outliers เปลี่ยนค่าข้อมูลที่ผิดปกติทางสถิติ

ฟังก์ชันนี้จะเปลี่ยนค่าผิดปกติทางสถิติเป็นค่าต่าง ๆ ตามคำสั่งที่ผู้ใช้เลือก โดยจะมี 2 ฟังก์ชันย่อยคือ
1. "clamp" : ทำการเปลี่ยนค่าผิดปกติทางสถิติเป็นค่าที่มากที่สุด หรือน้อยที่สุด (ขึ้นอยู่กับว่าข้อมูลนั้นเป็นไปในทิศทางใด) ที่ยังไม่เป็นค่าผิดปกติทางสถิติ
2. อื่น ๆ : (เป็นช่องให้ผู้ใช้ได้กรอก) ทำการเปลี่ยนค่าผิดปกติทางสถิติเป็นค่าที่ผู้ใช้ได้กรอก โดยถ้ากรอกค่าตัวเลข โปรแกรมจะทำการเปลี่ยนเป็น int หรือ float ให้ผู้ใช้โดยอัตโนมัติ
หากเลือกคอลัมน์ที่ไม่ใช่ตัวเลข (หรือมีอะไรที่ไม่ใช่ตัวเลข) ฟังก์ชันจะไม่เกิดการเปลี่ยนแปลงใด ๆ
ใช้วิธีหา Outlier แบบ IQR

### /changeoutlier/check "POST"
- usage : ใช้เช็คข้อมูลก่อนทำความสะอาด
- return : คืนค่าออกมาเป็น json ที่มีการเปลี่ยนแปลงข้อมูลที่มีความผิดปกติทางสถิติตามที่ผู้ใช้ต้องการ และมีค่า "st@tus" = "edit" ใน row ที่มีการเปลี่ยนแปลง
- addition :
"columns_match" : ["คอลัมน์ที่ผู้ใช้เลือก"]
"order_select" : "คำสั่งที่ผู้ใช้ต้องการ" (มีได้ 2 แบบคือ "clamp" หรือเป็นค่าอื่น ๆ)

### /changeoutlier/clean "POST"
- usage : ใช้ทำความสะอาดข้อมูลจริง
- return : คืนค่าออกมาเป็น json ที่มีการแก้ไขข้อมูลที่มีความผิดปกติทางสถิติตามที่ผู้ใช้ต้องการ
- addition :
 "columns_match" : ["คอลัมน์ที่ผู้ใช้เลือก"]
 "order_select" "คำสั่งที่ผู้ใช้ต้องการ" (มีได้ 2 แบบคือ "clamp" หรือเป็นค่าอื่น ๆ)